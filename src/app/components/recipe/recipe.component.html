<div *ngIf="recipe$ | async as recipe; else loading">
  <mat-card class="recipe-component">

    <div>
      <div class="recipe-component_image-btn-wrapper">
        <img mat-card-image
             src={{recipe.imageSrc}}
             alt={{recipe.title}}>
        <div class="recipe-component__buttons" *ngIf="currentUser; else isNotLoggedIn">
          <mat-card-actions>
            <app-favorite [recipeId]="recipeId" [userId]="userId"></app-favorite>
            <app-share></app-share>
          </mat-card-actions>

          <app-star-rating [recipeId]="recipeId" [userId]="userId"></app-star-rating>
        </div>

        <ng-template #isNotLoggedIn>
          <div class="recipe-component__isNotLoggedIn">
            <mat-card-actions>
              <app-share></app-share>
            </mat-card-actions>

            <p class="recipe-component__isNotLoggedIn--rating">
              Rating {{recipe.rating | number}}
            </p>
          </div>
        </ng-template>
      </div>

      <div class="recipe-component__info">
        <div class="recipe-component__info_title">
          <mat-card-title>{{recipe.title}}</mat-card-title>
          <h6>Coock duration: {{recipe.cookDuration}} min</h6>
        </div>

        <div class="recipe-component__info_ingredients">
          <h5>Ingredients:</h5>
          <div>
            <p *ngFor="let ingredient of recipe.ingredients">
              <mat-card-subtitle>
                <div class="ingredient-name">{{ingredient}} </div>
                <div class="ingredient-icon" #IngredientIcon *ngIf="imgSrc.indexOf(ingredient) !== -1" (click)="clickOnIngredient($event)">
                  <img class='icon' src="../../../assets/images/food-images/{{ingredient}}.png" alt={{ingredient}} name={{ingredient}}>
                </div>
              </mat-card-subtitle>
            </p>
          </div>
        </div>
      </div>
    </div>

    <mat-card-content class="recipe-component__recipe-content">
      <h3>Steps:</h3>
      <ol>
        <li *ngFor="let step of recipe.steps">{{step}}</li>
      </ol>

    </mat-card-content>

  </mat-card>
  <button class="back-btn" mat-button (click)="goBack()">Go back to recipes list
    <mat-icon>keyboard_backspace</mat-icon>
  </button>

  <mat-card id="videos">
    <mat-card-title>You might like to watch:</mat-card-title>
    <div>
      <iframe *ngFor="let url of recipe.videos" width="360" height="205"
              [src]="('https://www.youtube.com/embed/' + url) | safe" frameborder="0" allowfullscreen></iframe>
    </div>

  </mat-card>

</div>

  <ng-template #loading>
    <mat-spinner class="spinner"></mat-spinner>
  </ng-template>
